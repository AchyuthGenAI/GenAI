<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoreIntelli</title>
    <link rel="icon" type="image/webp" href="https://i.ibb.co/MCLkk0y/icon-png.webp">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100vh; /* Set the body height to 100% of the viewport */
            overflow: hidden; /* Prevent scrolling and any overflow */
            background-color: #2e333f;
            font-family: Arial, sans-serif;
            position: fixed; /* Fix the body in place */
            top: 0; /* Ensure it starts from the top */
            left: 0; /* Ensure it starts from the left */
        }

        .navbar {
            background-color: #2e333f;
            color: white;
            padding: 10px 20px;
        }

        .navbar-brand {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(45deg, #00c6ff, #0072ff, #ff00ff, #ff6f61);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .container {
            display: flex;
            height: calc(100vh - 70px);
            overflow: hidden;
        }

        /* Sidebar Styling */
        .sidebar {
            width: 300px;
            background-color: #14141470;
            color: #fff;
            overflow-y: auto;
            padding: 20px;
            position: fixed;
            left: 0;
            top: 70px;
            bottom: 0;
            z-index: 1000;
        }

        .sidebar h3 {
            font-size: 18px;
            font-weight: bold;
        }

        .history-item {
            padding: 10px;
            margin-bottom: 10px;
            background-color:#2e333f;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .history-item:hover {
            background-color: #555;
        }

        .search-bar {
            margin-bottom: 20px;
        }

        .search-bar input {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 5px;
            background-color: #3a3f4b;
            color: #fff;
        }

        .chat-container {
            margin-left: 300px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            background-color: #2e333f;
            height: 100%;
        }

        .chat-box {
            background-color: #2e333f;
            border-radius: 12px;
            padding: 20px;
            flex-grow: 1; /* Take up available space */
            overflow-y: auto; /* Enable scrolling */
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            animation: fadeIn 0.3s ease;
        }

        .message {
            margin: 10px 0;
            padding: 10px 15px;
            border-radius: 10px;
            width: fit-content;
            max-width: 70%;
            animation: fadeIn 0.3s ease;
        }

        .message.user {
            background-color: white;
            color: black;
            align-self: flex-end;
            border-radius: 200px;
        }

        .message.bot {
            color: white;
            align-self: flex-start;
            font-size: 17px;
        }

        .input-group {
            display: flex;
            padding: 10px 20px;
            background-color: #2e333f;
            position: relative;
            top: -40px; /* Move it up by 10px */
        }

        .input-group input {
            flex-grow: 1;
            padding: 10px 20px; /* Adjusted padding for better spacing */
            border: none;
            border-radius: 50px; /* Fully rounded corners */
            background-color: #444; /* Dark gray background */
            color: #fff; /* White text */
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1); /* Optional inner shadow for effect */
            transition: background-color 0.3s ease, box-shadow 0.3s ease; /* Smooth transitions */
        }

        .input-group input:focus {
            outline: none;
            background-color: #555; /* Lighter background on focus */
            box-shadow: 0 0 5px rgba(0, 198, 255, 0.5); /* Subtle glow effect */
        }

        .send-btn,
        .voice-btn {
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }

        .send-btn {
            background: linear-gradient(45deg, #00c6ff, #0072ff);
        }

        .voice-btn {
            background: linear-gradient(45deg, #ff00ff, #ff6f61);
            margin-left: 10px;
        }
        /* Hover effect */
        .send-btn:hover,
        .voice-btn:hover {
            color: black; /* Change the icon color to black on hover */
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2); /* Elevated shadow on hover */
            transform: scale(1.05); /* Slight zoom-in effect */
        }
        .send-btn:active,
        .voice-btn:hover:active {
            transform: scale(0.95); /* Slight zoom-out effect on click */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15); /* Reduced shadow */
        }

        /* Three-dot wave loader */
        .loader {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto;
        }

        .loader div {
            width: 10px;
            height: 10px;
            margin: 0 5px;
            border-radius: 50%;
            background-color: #3498db;
            animation: wave 1.5s infinite ease-in-out;
        }

        .loader div:nth-child(1) {
            animation-delay: -0.3s;
        }

        .loader div:nth-child(2) {
            animation-delay: -0.15s;
        }

        .loader div:nth-child(3) {
            animation-delay: 0s;
        }

        @keyframes wave {
            50%, 100% {
                transform: scale(0);
            }
            50% {
                transform: scale(1);
            }
        }

        footer {
            text-align: center;
            padding: 15px;
            background-color: transparent;
            color: #ddd;
            position: fixed;
            bottom: 0;
            width: 100%;
            font-size: 14px;
            margin-left: 150px;
        }

        footer a {
            color: #00adb5;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        footer a:hover {
            text-decoration: underline;
            color: #00bcd4;
        }

        footer p {
            margin: 5px 0;
        }

        footer .footer-link {
            margin-left: 10px;
        }
        /* Media Queries for Mobile and Tablet Screens */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
            }
            .chat-container {
                margin-left: 0;
            }
            .input-group input {
                width: 80%;
            }
            .send-btn, .voice-btn {
                width: 40px;
                height: 40px;
            }
            footer {
                margin-left: 0;
            }
        }

        /* Media Queries for Smaller Mobile Devices */
        @media (max-width: 480px) {
            .navbar-brand {
                font-size: 1.2rem;
            }
            .container {
                flex-direction: column;
            }
            .chat-box {
                padding: 10px;
            }
            .send-btn, .voice-btn {
                width: 35px;
                height: 35px;
                font-size: 16px;
            }
        }
        .fancy-button {
            background: linear-gradient(135deg, #6a11cb, #2575fc); /* Gradient background */
            color: white; /* Button text color */
            padding: 12px 24px; /* Spacing inside the button */
            font-size: 16px; /* Font size */
            font-weight: bold; /* Bold text */
            border: none; /* Remove border */
            border-radius: 25px; /* Rounded corners */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.06); /* Subtle shadow */
            cursor: pointer; /* Pointer cursor */
            transition: all 0.3s ease; /* Smooth transition effect */
        }

        .fancy-button:hover {
            background: linear-gradient(135deg, #2575fc, #6a11cb); /* Reverse gradient on hover */
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2); /* Elevated shadow on hover */
            transform: scale(1.05); /* Slight zoom-in effect */
        }

        .fancy-button:active {
            transform: scale(0.95); /* Slight zoom-out effect on click */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15); /* Reduced shadow */
        }
    </style>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar navbar-dark">
        <a class="navbar-brand"><i class="fas fa-comments"></i> CoreIntelli</a>
    </nav>

    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="search-bar">
                <input type="text" id="searchBar" placeholder="Search chat history">
            </div>
            <h3>Chat History</h3>
            <div id="chatHistory">
                <!-- Chat history items -->
                <div class="history-item">Chat 1</div>
                <div class="history-item">Chat 2</div>
            </div>
        </aside>

        <!-- Chat Section -->
        <div class="chat-container">
            <div id="controls" style="text-align: left; margin: 20px;">
                <button id="newChatBtn" class="fancy-button">New Chat</button>
            </div>
            <div class="chat-box" id="chatBox">
                <!-- Messages will be dynamically added here -->
            </div>
            <div class="input-group">
                <input type="text" id="userInput" placeholder="Type your message...">
                <button class="send-btn" id="sendBtn"><i class="fas fa-paper-plane"></i></button>
                <button class="voice-btn" id="voiceBtn"><i class="fas fa-microphone"></i></button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <p>&copy; 2024 AI Chatbot | <a href="#" class="footer-link">Privacy Policy</a> | <a href="#" class="footer-link">Terms of Service</a></p>
    </footer>
    
    <script>
        const baseUrl = 'https://api.aimlapi.com/chat/completions'; // Replace with your API URL
        const apiKey = 'cc2d8a7a189948be901cc38fb8bddc8e'; // Replace with your API key
        const chatBox = document.getElementById('chatBox');
        const userInput = document.getElementById('userInput');
        const sendBtn = document.getElementById('sendBtn');
        const voiceBtn = document.getElementById('voiceBtn');
        const chatHistory = document.getElementById('chatHistory');
        const searchBar = document.getElementById('searchBar');
        const newChatBtn = document.getElementById('newChatBtn');
        let recognizing = false;

        
        // Function to reset the chat box
        function resetChat() {
            // Clear the chat box content
            chatBox.innerHTML = '';
            // Optionally, scroll to the top of the chat box
            chatBox.scrollTop = 0;
            // Optionally, reset any other variables or UI elements
            userInput.value = ''; // Clear the input field
            localStorage.clear(); // Clear saved chat history if applicable
        }

        // Add event listener to the button
        newChatBtn.addEventListener('click', resetChat);

         // Auto-resize the textarea based on content
        userInput.addEventListener("input", () => {
            userInput.style.height = "auto"; // Reset height to calculate new height
            userInput.style.height = userInput.scrollHeight + "px"; // Adjust height to content
        });

        // Optional: Reset height when input is cleared
        userInput.addEventListener("keydown", (event) => {
            if (event.key === "Enter" && !event.shiftKey) {
                event.preventDefault(); // Prevent newline on Enter
                document.getElementById("sendBtn").click(); // Trigger the send button click
                userInput.style.height = "auto"; // Reset height after sending
            }
        });
    
        // Function to append messages to chat
        function appendMessage(content, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message', sender);

            if (sender === 'bot') {
                // Add bot icon beside the message
                const iconImg = document.createElement('img');
                iconImg.src = 'https://i.ibb.co/MCLkk0y/icon-png.webp'; // Your image URL
                iconImg.alt = 'CoreIntelli Bot';
                iconImg.style.width = '50px';
                iconImg.style.height = '40px';
                iconImg.style.marginRight = '10px';
                iconImg.style.borderRadius = '50%';
                iconImg.style.objectFit = 'cover';

                const messageContainer = document.createElement('div');
                messageContainer.style.display = 'flex';
                messageContainer.style.alignItems = 'flex-start';

                // Format the bot's response content
                const formattedContent = formatResponse(content);
                const messageContent = document.createElement('div');
                messageContent.innerHTML = formattedContent;

                // Append icon and message content to container
                messageContainer.appendChild(iconImg);
                messageContainer.appendChild(messageContent);

                messageDiv.appendChild(messageContainer);
            } else {
                // For user messages, directly add content
                const formattedContent = content; // No formatting for user messages
                messageDiv.innerHTML = formattedContent;
            }

            chatBox.appendChild(messageDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        // Format plain text responses
        function formatTextResponse(response) {
            return `<p>${response}</p>`;
        }

        // Format bullet list responses without bullet dots
        function formatListResponse(response) {
            const items = response.split('\n').map(item => `<div>${item}</div>`).join('');
            return `<div>${items}</div>`;
        }

        function formatCodeResponse(response) {
            return `<pre style="padding: 10px; border-radius: 5px; white-space: pre-wrap; word-wrap: break-word; max-width: 100%;">${response}</pre>`;
        }


        // Format image responses
        function formatImageResponse(response) {
            return `<img src="${response}" alt="Bot-suggested image" style="max-width: 100%; border-radius: 5px;">`;
        }

        // Format links in responses
        function formatLinkResponse(response) {
            return response.replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank">$1</a>');
        }

        // Format table responses
        function formatTableResponse(response) {
            const rows = response.split('\n').map(row => {
                const cells = row.split('|').map(cell => `<td>${cell.trim()}</td>`).join('');
                return `<tr>${cells}</tr>`;
            }).join('');
            return `<table border="1" style="width: 100%; border-collapse: collapse;">${rows}</table>`;
        }

        function formatJsonResponse(response) {
            try {
                const data = JSON.parse(response);

                // Dynamically handle different types
                switch (data.type) {
                    case 'image':
                        return formatImageResponse(data.url);
                    case 'list':
                        return formatListResponse(data.items.join('\n'));
                    case 'text':
                        return formatTextResponse(data.content);
                    case 'code':
                        return formatCodeResponse(data.content);
                    case 'table':
                        return formatTableResponse(data.content);
                    case 'link':
                        return formatLinkResponse(data.url);
                    default:
                        console.warn('Unknown response type:', data.type);
                        return formatTextResponse('Unsupported response type: ' + data.type);
                }
            } catch (error) {
                console.error('Error parsing JSON response:', error);

                // Fallback: Return the response as plain text or try to format it
                return formatTextResponse(
                    typeof response === 'string' ? response : 'Invalid response format.'
                );
            }
        }

        // Format Dynamic Response
        function formatResponse(response) {
            if (response.startsWith('{') && response.endsWith('}')) {
                return formatJsonResponse(response); // JSON response
            } else if (response.includes('|')) {
                return formatTableResponse(response); // Detect table
            } else if (response.includes('http')) {
                return formatLinkResponse(response); // Detect links
            } else if (response.includes('\n')) {
                return formatCodeResponse(response); // Detect Python code
            } else if (response.includes('\n')) {
                return formatListResponse(response); // Detect list
            } else {
                return formatTextResponse(response); // Default to text
            }
        }
    
       // Chat History
    function addToHistory(question, response) {
        const historyItem = document.createElement('div');
        historyItem.classList.add('history-item');
        historyItem.style.display = 'flex';
        historyItem.style.justifyContent = 'space-between';
        historyItem.style.alignItems = 'center';
        historyItem.style.marginBottom = '10px';

        const now = new Date();
        const formattedTime = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        const formattedDate = now.toLocaleDateString();

        const keyword = summarizeResponse(response);

        const messageContainer = document.createElement('div');
        messageContainer.innerHTML = `
            <div><strong>${question}</strong></div>
            <small>${formattedDate} ${formattedTime} | ${keyword}</small>
        `;

        const deleteBtn = document.createElement('img');
        deleteBtn.src = 'data:image/png;base64,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'; // Use a direct link to the image file
        deleteBtn.alt = 'Delete';
        deleteBtn.style.width = '20px';
        deleteBtn.style.height = '20px';
        deleteBtn.style.cursor = 'pointer';

        deleteBtn.addEventListener('click', () => {
            chatHistory.removeChild(historyItem);
            const savedHistory = JSON.parse(localStorage.getItem('chatHistory') || '[]');
            const updatedHistory = savedHistory.filter(
                item => item.question !== question && item.response !== response
            );
            localStorage.setItem('chatHistory', JSON.stringify(updatedHistory));
        });

        messageContainer.addEventListener('click', () => {
            appendMessage(`<strong>Context:</strong> ${question}<br>${response}`, 'bot');
        });

        historyItem.appendChild(messageContainer);
        historyItem.appendChild(deleteBtn);
        chatHistory.appendChild(historyItem);

        saveHistoryToLocalStorage();
    }

    function summarizeResponse(response) {
        return response.split(' ').slice(0, 5).join(' ') + '...';
    }

    function saveHistoryToLocalStorage() {
        const historyItems = Array.from(chatHistory.getElementsByClassName('history-item')).map(item => {
            const question = item.querySelector('strong').innerText;
            const keyword = item.querySelector('small').innerText.split('|')[1].trim();
            return { question, keyword };
        });
        localStorage.setItem('chatHistory', JSON.stringify(historyItems));
    }

    function loadHistoryFromLocalStorage() {
        // Clear existing chat history to prevent duplication
        chatHistory.innerHTML = '';

        const savedHistory = JSON.parse(localStorage.getItem('chatHistory') || '[]');
        savedHistory.forEach(({ question, keyword }) => {
            const response = localStorage.getItem(`response_${question}`);
            if (response) {
                // Add the history item if the response exists in localStorage
                addToHistory(question, response);
            }
        });
    }

    // Function to generate response with context
    function sendMessage() {
        const question = userInput.value.trim();
        if (question !== '') {
            appendMessage(`${question}`, 'user');
            userInput.value = '';
            userInput.focus();

            const loader = document.createElement('div');
            loader.classList.add('loader');
            for (let i = 0; i < 3; i++) {
                const dot = document.createElement('div');
                loader.appendChild(dot);
            }
            chatBox.appendChild(loader);

            // Get chat history from local storage to maintain context
            const savedHistory = JSON.parse(localStorage.getItem('chatHistory') || '[]');
            const contextMessages = savedHistory.map(item => ({
                role: "user",
                content: item.question
            }));

            // Add the current user question to the context
            contextMessages.push({
                role: "user",
                content: question
            });

            fetch(baseUrl, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${apiKey}`,
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    model: "gpt-3.5-turbo",
                    messages: contextMessages,
                }),
            })
                .then(response => response.json()) // Parse the JSON response
                .then(data => {
                    chatBox.removeChild(loader); // Remove the loader once the response is received

                    if (data && data.choices && data.choices.length > 0) {
                        let botResponse = data.choices[0].message.content;

                        // Replace "Subscription" with a clickable link
                        const subscriptionLink = '<a href="https://aimlapi.com/app/billing/plans" target="_blank" style="color: #4CAF50; text-decoration: none;">Subscription</a>';
                        botResponse = botResponse.replace("Subscription", subscriptionLink);

                        appendMessage(botResponse, 'bot'); // Function to append the bot's response to the chat
                        addToHistory(question, botResponse); // Function to store the chat history
                        localStorage.setItem(`response_${question}`, botResponse); // Store the response in localStorage
                    } else {
                        // Handle case when no response or choices are returned
                        appendMessage("Oops! Something went wrong. Please try again later or Click on the Given Link which is Provided " + "https://aimlapi.com/app/billing/plans", 'bot'); 
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    chatBox.removeChild(loader);
                    appendMessage("Error occurred. Try again later.", 'bot');
                });
            }
        }

          // Speech recognition setup
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'en-US';
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;
    
        recognition.onresult = (event) => {
            const transcript = event.results[0][0].transcript;
            userInput.value = transcript;
            sendMessage();
        };
    
        recognition.onerror = (event) => {
            console.error('Speech recognition error:', event.error);
            appendMessage("Sorry, couldn't recognize your voice. Please try again.", 'bot');
        };
    
        // Toggle voice recognition
        voiceBtn.addEventListener('click', () => {
            if (!recognizing) {
                recognition.start();
                recognizing = true;
                voiceBtn.innerHTML = '<i class="fas fa-microphone"></i>';
            } else {
                recognition.stop();
                recognizing = false;
                voiceBtn.innerHTML = '<i class="fas fa-microphone"></i>';
            }
        });
    
        // Event listener for Send button
        sendBtn.addEventListener('click', sendMessage);
    
        // Event listener for Enter key
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Initialize chat history on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadHistoryFromLocalStorage();
        });

        // Event listener for Send button
        sendBtn.addEventListener('click', sendMessage);

        // Event listener for Enter key
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    
        searchBar.addEventListener('input', (e) => {
            const searchText = e.target.value.toLowerCase();
            const items = document.querySelectorAll('.history-item');
            items.forEach(item => {
                if (item.textContent.toLowerCase().includes(searchText)) {
                    item.style.display = '';
                } else {
                    item.style.display = 'none';
                }
            });
        });
    
        document.addEventListener('DOMContentLoaded', loadHistoryFromLocalStorage);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
